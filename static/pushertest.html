<!DOCTYPE html>
<head>
<title>Pusher Test</title>
<script src="http://js.pusher.com/1.12/pusher.min.js" type="text/javascript"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">
Pusher.channel_auth_endpoint = '/pusher2talk/pusherauth';
var pusher = new Pusher('c75e1662bedf930571b3');
var channel = pusher.subscribe("private-test");

function bind_event(){
	channel.bind('client-talk', function(data) {
			document.getElementById('status').innerHTML = "Talking:"+ data.user;
			var sound = document.getElementById("sound1");
			sound.Play();
	   		}
	);
	channel.bind('client-stop', function(data) {
			document.getElementById('status').innerHTML = "";
			var sound = document.getElementById("sound1");
			sound.Play();
			   		}
	);		
	document.getElementById('status').innerHTML = "Ready:";
	
}

function ptt_on(){		
	channel.bind('pusher:subscription_succeeded', function() {
  		var triggered = channel.trigger('client-talk', { "user" : "TestUser" });
	});
}
function ptt_off(){
	channel.bind('pusher:subscription_succeeded', function() {
  		var triggered = channel.trigger('client-stop', { "user" : "TestUser" });
	});
}

	
</script>
</head>

<body>

<div id="status"></div>
<embed src="chirp.mp3" autostart="false" width="0" height="0" id="sound1" enablejavascript="true">
<button onclick="bind_event()">Subcribe</button>
<button onclick="ptt_on()">Start Talk</button>
<button onclick="ptt_off()">Stop Talk</button>


</div>

</body> 
</html>